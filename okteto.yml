name: Project-EDE

# The build section defines how to build the images of your development environment
# More info: https://www.okteto.com/docs/reference/manifest/#build
build:

  # You can use the following env vars to refer to this image in your deploy commands:
  #  - OKTETO_BUILD_AIRPORT_SERVICE_REGISTRY: image registry
  #  - OKTETO_BUILD_AIRPORT_SERVICE_REPOSITORY: image repo
  #  - OKTETO_BUILD_AIRPORT_SERVICE_IMAGE: image name
  #  - OKTETO_BUILD_AIRPORT_SERVICE_SHA: image tag sha256
  airport-service:
    context: airport-service
    dockerfile: airport-service\Dockerfile

  # You can use the following env vars to refer to this image in your deploy commands:
  #  - OKTETO_BUILD_API_GATEWAY_REGISTRY: image registry
  #  - OKTETO_BUILD_API_GATEWAY_REPOSITORY: image repo
  #  - OKTETO_BUILD_API_GATEWAY_IMAGE: image name
  #  - OKTETO_BUILD_API_GATEWAY_SHA: image tag sha256
  api-gateway:
    context: api-gateway
    dockerfile: api-gateway\Dockerfile

  # You can use the following env vars to refer to this image in your deploy commands:
  #  - OKTETO_BUILD_FLIGHT_SERVICE_REGISTRY: image registry
  #  - OKTETO_BUILD_FLIGHT_SERVICE_REPOSITORY: image repo
  #  - OKTETO_BUILD_FLIGHT_SERVICE_IMAGE: image name
  #  - OKTETO_BUILD_FLIGHT_SERVICE_SHA: image tag sha256
  flight-service:
    context: flight-service
    dockerfile: flight-service\Dockerfile

  # You can use the following env vars to refer to this image in your deploy commands:
  #  - OKTETO_BUILD_GATE_SERVICE_REGISTRY: image registry
  #  - OKTETO_BUILD_GATE_SERVICE_REPOSITORY: image repo
  #  - OKTETO_BUILD_GATE_SERVICE_IMAGE: image name
  #  - OKTETO_BUILD_GATE_SERVICE_SHA: image tag sha256
  gate-service:
    context: gate-service
    dockerfile: gate-service\Dockerfile

  # You can use the following env vars to refer to this image in your deploy commands:
  #  - OKTETO_BUILD_PASSENGER_SERVICE_REGISTRY: image registry
  #  - OKTETO_BUILD_PASSENGER_SERVICE_REPOSITORY: image repo
  #  - OKTETO_BUILD_PASSENGER_SERVICE_IMAGE: image name
  #  - OKTETO_BUILD_PASSENGER_SERVICE_SHA: image tag sha256
  passenger-service:
    context: passenger-service
    dockerfile: passenger-service\Dockerfile

# The deploy section defines how to deploy your development environment
# More info: https://www.okteto.com/docs/reference/manifest/#deploy
deploy:
  - kubectl apply -f kubernetes

# The dependencies section defines other git repositories to be deployed as part of your development environment
# More info: https://www.okteto.com/docs/reference/manifest/#dependencies
# dependencies:
#   - https://github.com/okteto/sample


# The dev section defines how to activate a development container
# More info: https://www.okteto.com/docs/reference/manifest/#dev
dev:
  airport-service:
    image: okteto/maven:3
    command: bash
    forward:
      - 5005:5005
      - 8081:8081
    volumes:
      - /root/.m2
    sync:
      - airport-service:/usr/src/app
  api-gateway:
    image: okteto/maven:3
    command: bash
    forward:
      - 5005:5005
      - 8085:8085
    volumes:
      - /root/.m2
    sync:
      - api-gateway:/usr/src/app
  flight-service:
    image: okteto/maven:3
    command: bash
    forward:
      - 5005:5005
      - 8082:8082
    volumes:
      - /root/.m2
    sync:
      - flight-service:/usr/src/app
  gate-service:
    image: okteto/maven:3
    command: bash
    forward:
      - 5005:5005
      - 8083:8083
    volumes:
      - /root/.m2
    sync:
      - gate-service:/usr/src/app
  mongo-airport:
    image: okteto/maven:3
    command: bash
    forward:
      - 5005:5005
      - 27017:27017
    volumes:
      - /root/.m2
    sync:
      - .:/usr/src/app
  mysql-flight:
    image: okteto/maven:3
    command: bash
    forward:
      - 5005:5005
      - 3306:3306
    volumes:
      - /root/.m2
    sync:
      - .:/usr/src/app
  mysql-gate:
    image: okteto/maven:3
    command: bash
    forward:
      - 5005:5005
      - 3306:3306
    volumes:
      - /root/.m2
    sync:
      - .:/usr/src/app
  mysql-passenger:
    image: okteto/maven:3
    command: bash
    forward:
      - 5005:5005
      - 3306:3306
    volumes:
      - /root/.m2
    sync:
      - .:/usr/src/app
  passenger-service:
    image: okteto/maven:3
    command: bash
    forward:
      - 5005:5005
      - 8084:8084
    volumes:
      - /root/.m2
    sync:
      - passenger-service:/usr/src/app

